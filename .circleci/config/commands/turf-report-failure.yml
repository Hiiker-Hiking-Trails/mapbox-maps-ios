parameters:
  turf-revision:
    type: string
steps:
  - run:
      when: on_fail
      name: Set Turf commit status to failure
      command: |
        curl --request POST \
          --url https://api.github.com/repos/mapbox/turf-swift/statuses/<< parameters.turf-revision >> \
          --header 'Accept: application/vnd.github.v3+json' \
          --header "Authorization: token $(mbx-ci github notifier token)" \
          --data "{\"state\":\"failure\",\"target_url\":\"$CIRCLE_BUILD_URL\",\"description\":\"MapboxMaps SDK integration tests failed\",\"context\":\"Maps SDK Integration\"}"
